import{r as d,W as H,j as e}from"./app-CXhxP4IC.js";import{T as v,D as A}from"./index-DDdEYXzY.js";import{T as t}from"./index-ByMu0qn2.js";import{S as P}from"./Select-C-exctFT.js";import{s as u,T as z}from"./index-uIOWaCi_.js";import{F as $}from"./index-CRiK872-.js";import{s as q}from"./trade.module-DNpBJkAs.js";import{B as E}from"./index-BWw7OOr8.js";import{B as M}from"./button.esm-BWtOUSc7.js";import{G}from"./iconBase-DWzPX-n0.js";import{j as R,a as L}from"./index-SyAJMH_1.js";import{M as V}from"./message.esm-GcpnwvdI.js";import"./tooltip.esm-A3nGpM54.js";import"./index.esm-CrCcFfvx.js";import"./objectWithoutPropertiesLoose-BwfzGx52.js";import"./iconbase.esm-Cq4ooEvg.js";import"./ripple.esm-CLCo6fDN.js";import"./inputtext.esm-GbgemPKy.js";import"./index-Cur7t6HG.js";import"./index-CGiUeyTh.js";import"./Dropdown-XGO5mqUA.js";import"./StyledButton-DM_a2VOH.js";import"./index.esm-DVhXXx0K.js";import"./index.esm-BrhfK6k7.js";function Z(a){return G({tag:"svg",attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M2 7.5C2 7.22386 2.22386 7 2.5 7H12.5C12.7761 7 13 7.22386 13 7.5C13 7.77614 12.7761 8 12.5 8H2.5C2.22386 8 2 7.77614 2 7.5Z",fill:"currentColor"},child:[]}]})(a)}const fe=({channel:a,services:D=[],wallet:r})=>{const[s,b]=d.useState(),[k,x]=d.useState(""),[h,_]=d.useState(!1),[p,y]=d.useState(!1),[N,I]=d.useState(0),[j,F]=d.useState(),{data:n,setData:m,post:W,processing:S,errors:f,reset:J}=H({amount:null,currency_id:r==null?void 0:r.curr.id,wallet_id:r==null?void 0:r.id,wallet_address:"",type:"wallet",charge:0,network:"",ecoreuser:null});d.useEffect(()=>{r&&(a=="@ecore"?(b({commission:{fee_amount:"0",percent:"0"},currency:r.curr.code,is_available:!0,limit:{max_amount:r.curr.charges.withdraw_limit_max,min_amount:r.curr.charges.withdraw_limit_min},network:""}),x(""),m({...n,currency_id:r.curr.id,wallet_id:r.id,type:"@ecore"})):b(void 0))},[a,r]);const g=i=>{var o;(o=i.preventDefault)==null||o.call(i),W(route("user.crypto.process.withdraw")),h?_(!1):p&&y(!1)},T=e.jsx("div",{children:e.jsx(v,{label:"Amount",placeholder:"Enter Amount",type:"number",desc:u(s&&r,e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Total Fee"}),e.jsx(Z,{}),e.jsx("span",{children:N})]})),errorText:k||f.amount,onChange:i=>{const o=parseFloat(i.target.value||"0.0")||0;if(!s||!r)return;const B=parseFloat(r.all_balance.available),C=r==null?void 0:r.curr.charges;let c=parseFloat(a!=="@ecore"&&(C==null?void 0:C.withdraw_charge)||"0.0");c&&c>0&&(c=o*(c/100)+(parseFloat((s==null?void 0:s.commission.fee_amount)||"0.0")||0)),o<parseFloat((s==null?void 0:s.limit.min_amount)||"0.0")||o>parseFloat((s==null?void 0:s.limit.max_amount)||"100")?x(`Min amount is ${s==null?void 0:s.limit.min_amount}, Max is ${s==null?void 0:s.limit.max_amount}`):r&&c+o>B?x("Insufficient Funds"):k&&x(""),I(o>0?c:0),m("amount",o)}})});switch(a){case"wallet":return e.jsxs("form",{onSubmit:g,className:"flex flex-col gap-3",children:[e.jsx("div",{children:u(j,e.jsx(V,{className:"w-full !justify-start",severity:"warn",text:j}))}),e.jsx("div",{children:e.jsx(v,{desc:u(s,e.jsxs(e.Fragment,{children:["Min: ",s==null?void 0:s.limit.min_amount,", Max: ",s==null?void 0:s.limit.max_amount]})),errorText:f.network,label:"Network",inputElement:()=>e.jsx(z,{element:P,items:D.filter(i=>i.currency===(r==null?void 0:r.curr.code)),contentTemplate:i=>e.jsxs("div",{children:[e.jsx("span",{children:r==null?void 0:r.curr.code}),"-",e.jsx("span",{children:i.network})]}),menuItemTemplate:i=>e.jsxs("div",{children:[e.jsxs(t,{light:!0,bright:!0,className:"gap-2",noPad:!0,sm:!0,children:[e.jsx("span",{children:"fee"})," ",e.jsx($,{})," ",i.commission.fee_amount]}),e.jsxs(t,{noPad:!0,lg:!0,children:[e.jsx("span",{children:r==null?void 0:r.curr.code}),"-",e.jsx("span",{children:i.network})]})]}),unique:"network",outlined:!0,className:q.mobileNetwork,quick:!0,trigger:"!bg-transparent",value:s,onSelect:i=>{m({...n,network:i.value.network,charge:i.value.commission.fee_amount,currency_id:r==null?void 0:r.curr.id,wallet_id:r==null?void 0:r.id}),b(i.value)},container:"!px-[8px] !py-[1px]"})})}),e.jsx("div",{children:e.jsx(v,{label:"Wallet address",placeholder:"Enter wallet address",type:"text",errorText:f.wallet_address,onChange:i=>m("wallet_address",i.target.value)})}),T,e.jsx(M,{type:"button",disabled:S,onClick:()=>{n.amount&&n.network&&n.wallet_address?_(!0):!j&&F("Fill in all fields")},className:"justify-center",children:"Continue"}),e.jsx(A,{className:"max-w-[350px]",footer:i=>e.jsx(E,{onClick:g,size:"normal",bgColor:"primary",children:"Confirm"}),header:"Summary",visible:h,style:{width:"50vw"},onHide:()=>{h&&_(!1)},children:u(h,e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Network"}),e.jsx(t,{bold:!0,children:n.network})]})}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Amount"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(t,{bold:!0,children:n.amount}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{children:"Fee"}),e.jsx(R,{}),e.jsx(t,{noPad:!0,children:N})]})]})]})}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Wallet Address"}),e.jsx(t,{bold:!0,children:n.wallet_address})]})})]}))})]});case"@ecore":return e.jsxs("form",{onSubmit:g,className:"flex flex-col gap-3",children:[e.jsx("div",{children:e.jsx(v,{errorText:f.ecoreuser,onChange:i=>{const o=i.target.value;m("ecoreuser",o)},label:"Ecore Id",placeholder:"6 digit ID"})}),T,e.jsx(M,{type:"button",onClick:()=>{n.amount&&n.ecoreuser?y(!0):!j&&F("Fill in all fields")},disabled:S,className:"justify-center",children:"Continue"}),e.jsx(A,{className:"max-w-[350px]",footer:i=>e.jsx(E,{onClick:g,size:"normal",bgColor:"primary",children:"Confirm"}),header:"Summary",visible:p,style:{width:"50vw"},onHide:()=>{p&&y(!1)},children:u(p,e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Send To"}),e.jsx(t,{bold:!0,children:n.ecoreuser})]})}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Amount"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(t,{bold:!0,children:n.amount}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(t,{children:"Fee"}),e.jsx(R,{}),e.jsx(t,{noPad:!0,children:N})]})]})]})}),e.jsx(l,{children:e.jsxs("div",{children:[e.jsx(t,{children:"Wallet Address"}),e.jsx(t,{bold:!0,children:n.wallet_address})]})})]}))})]})}},l=({children:a})=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{children:e.jsx(L,{})}),e.jsx("div",{children:a})]});export{fe as default};
