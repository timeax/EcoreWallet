import{r as i,j as e,Y as A,W as F}from"./app-DPeqRPcX.js";import{B as m}from"./index-BuV88OsN.js";import{U as H,d as L,T as M}from"./index-BtqGtben.js";import{T as g}from"./index-Dfq4-ipG.js";import{S as q}from"./Select-CJRs8Qvl.js";import{D as z}from"./dialog.esm-B90dCpDH.js";import{s as B}from"./index-DOPl3nEV.js";import{c as I}from"./index-euvBnKB1.js";import"./StyledButton-ciDqVOpa.js";import"./inputtext.esm-DpYC840t.js";import"./componentbase.esm-CEyx904k.js";import"./tooltip.esm-B48pQ4fn.js";import"./portal.esm-ZPKbRoAC.js";import"./index-CFd3A8tf.js";import"./iconBase-BE7iW8MJ.js";import"./Dropdown-VWJDfQuR.js";import"./index.esm-UiDtkRAd.js";import"./objectWithoutPropertiesLoose-BwfzGx52.js";import"./iconbase.esm-CycjtHYb.js";import"./ripple.esm-BKB6VsNq.js";function re({auth:S,error:k,errors:c,flash:C,templates:u,...o}){const[f,r]=i.useState([]);return e.jsxs(e.Fragment,{children:[e.jsx(A,{title:"Edit Email templates",children:e.jsx("style",{children:`
                        body {
                            height: 100vh;
                            overflow: auto
                        }
                    `})}),e.jsx(m,{onClick:()=>r([...f,{codes:{},email_body:"<span>Hello {name}</span>",email_subject:"new_template",email_type:"Unset",status:1}]),children:"New Template"}),e.jsx(m,{onClick:async t=>{const l=await window.axios.post(route("resend.hook"));console.log(l)},children:"Resend hook"}),e.jsxs("div",{className:"flex flex-wrap gap-x-10 justify-center",children:[f.map((t,l)=>e.jsx(T,{...t,databases:Object.keys(o).map(p=>({label:p,value:o[p]}))},l)),u.map(t=>e.jsx(T,{...t,databases:Object.keys(o).map(l=>({label:l,value:o[l]}))},t.id))]})]})}const T=({email_body:S,id:k,codes:c,email_subject:C,email_type:u,databases:o})=>{const[f,r]=i.useState(!1),[t,l]=i.useState(Object.keys(c).map(a=>({name:a,meaning:c[a]}))),p=()=>{l(Object.keys(c).map(a=>({name:a,meaning:c[a]})))},[d,x]=i.useState(""),[_,O]=i.useState(void 0),[j,h]=i.useState(""),[N,D]=i.useState(!1),[v,b]=i.useState(""),{data:w,setData:y,post:U,errors:E}=F({id:k,codes:{},email_body:S,email_subject:C,email_type:u,status:1});return i.useEffect(()=>{if(d){let a=t.find(s=>s.name==d);a&&(h(a.name),b(a.meaning)),r(!0)}},[d]),i.useEffect(()=>{Object.keys(E).length>0&&console.log(E)},[]),i.useEffect(()=>{N&&(console.log(w),U(route("template")))},[N]),e.jsxs(H,{body:"!overflow-visible",container:"!overflow-visible",className:"w-[31%] !overflow-visible my-6",header:e.jsx(L,{title:u}),children:[e.jsxs(z,{visible:f,onHide:()=>r(!1),header:"Add Code",children:[e.jsx(g,{onChange:a=>h(a.target.value),value:j,label:"Name"}),e.jsx(g,{onChange:a=>b(a.target.value),value:v,label:"Meaning"}),e.jsx(m,{onClick:()=>{let a=t;if(d){let s=t.find(n=>n.name==d);s&&(a=t.filter(n=>n.name!==s.name))}j&&v&&l([...a.filter(s=>s.name!==j),{name:j,meaning:v}]),r(!1),x("")},className:"mt-4",children:"Add"})]}),e.jsxs("div",{className:"flex gap-3 flex-col",children:[e.jsx(g,{onChange:a=>y("email_type",a.target.value),value:w.email_type,label:"Type"}),e.jsx(g,{onChange:a=>y("email_subject",a.target.value),value:w.email_subject,label:"Subject"}),e.jsxs("div",{className:"flex grow flex-col gap-3",children:[e.jsx("div",{className:"flex grow flex-wrap gap-2",children:t.map((a,s)=>e.jsxs("div",{className:"flex p-1 gap-2 border",children:[e.jsx(M,{noPad:!0,className:"my-1",normal:!0,children:a.name}),e.jsx("button",{onClick:()=>l(t.filter(n=>a.name!==n.name)),children:e.jsx(I,{})}),e.jsx("button",{onClick:()=>x(a.name),children:e.jsx(B,{})})]},s))}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(m,{onClick:()=>{h(""),x(""),b(""),r(!0)},size:"normal",shape:"pill",children:"add key"}),e.jsx(q,{value:_,items:o,placeholder:"Map to Table",quick:!0,unique:"label",contained:!0,className:"bg-theme-button rounded-lg",gap:9,onSelect:async a=>{await window.confirm("Are you sure")&&(l(a.value.value.map(n=>({name:n,meaning:n}))),O(a.value))}}),e.jsx(m,{onClick:()=>{h(""),x(""),b(""),p()},size:"normal",shape:"pill",children:"reset"})]})]}),e.jsx(m,{centered:!0,onClick:async()=>{let a={};t.forEach(n=>a[n.name]=n.meaning),y("codes",a);const s=await window.confirm("You want to submit?");s&&D(s)},children:"Submit"})]})]})};export{re as default};
