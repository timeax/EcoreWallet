import{R as p,r as R,j as n,y as $,c as G}from"./app-DPeqRPcX.js";import{T as o,s as J,n as k}from"./index-BtqGtben.js";import{B as Q}from"./index-BuV88OsN.js";import{S as V}from"./sidebar.esm-C28GSpQQ.js";import{P as x,C as A}from"./currency-format-BghgJM0E.js";import{p as X,k as Y}from"./index-DOPl3nEV.js";import{u as Z}from"./AuthenticatedContext-YAhfpYvk.js";var ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},ne=function(){function e(t,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}();function te(e,t){var i={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(i[r]=e[r]);return i}function re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ie(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var M=function(e){ae(t,e);function t(){var i;re(this,t);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];var a=ie(this,(i=t.__proto__||Object.getPrototypeOf(t)).call.apply(i,[this].concat(s)));return a.state={},a.styles={ellipsis:{position:"fixed",visibility:"hidden",top:0,left:0}},a.elements={},a.onResize=a.onResize.bind(a),a.onTruncate=a.onTruncate.bind(a),a.calcTargetWidth=a.calcTargetWidth.bind(a),a.measureWidth=a.measureWidth.bind(a),a.getLines=a.getLines.bind(a),a.renderLine=a.renderLine.bind(a),a}return ne(t,[{key:"componentDidMount",value:function(){var r=this.elements.text,s=this.calcTargetWidth,c=this.onResize,a=document.createElement("canvas");this.canvasContext=a.getContext("2d"),s(function(){r&&r.parentNode.removeChild(r)}),window.addEventListener("resize",c)}},{key:"componentDidUpdate",value:function(r){this.props.children!==r.children&&this.forceUpdate(),this.props.width!==r.width&&this.calcTargetWidth()}},{key:"componentWillUnmount",value:function(){var r=this.elements.ellipsis,s=this.onResize,c=this.timeout;r.parentNode.removeChild(r),window.removeEventListener("resize",s),window.cancelAnimationFrame(c)}},{key:"innerText",value:function(r){var s=document.createElement("div"),c="innerText"in window.HTMLElement.prototype?"innerText":"textContent";s.innerHTML=r.innerHTML.replace(/\r\n|\r|\n/g," ");var a=s[c],u=document.createElement("div");return u.innerHTML="foo<br/>bar",u[c].replace(/\r\n|\r/g,`
`)!==`foo
bar`&&(s.innerHTML=s.innerHTML.replace(/<br.*?[\/]?>/gi,`
`),a=s[c]),a}},{key:"onResize",value:function(){this.calcTargetWidth()}},{key:"onTruncate",value:function(r){var s=this.props.onTruncate;typeof s=="function"&&(this.timeout=window.requestAnimationFrame(function(){s(r)}))}},{key:"calcTargetWidth",value:function(r){var s=this.elements.target,c=this.calcTargetWidth,a=this.canvasContext,u=this.props.width;if(s){var l=u||Math.floor(s.parentNode.getBoundingClientRect().width);if(!l)return window.requestAnimationFrame(function(){return c(r)});var d=window.getComputedStyle(s),h=[d["font-weight"],d["font-style"],d["font-size"],d["font-family"]].join(" ");a.font=h,this.setState({targetWidth:l},r)}}},{key:"measureWidth",value:function(r){return this.canvasContext.measureText(r).width}},{key:"ellipsisWidth",value:function(r){return r.offsetWidth}},{key:"trimRight",value:function(r){return r.replace(/\s+$/,"")}},{key:"getLines",value:function(){for(var r=this.elements,s=this.props,c=s.lines,a=s.ellipsis,u=s.trimWhitespace,l=this.state.targetWidth,d=this.innerText,h=this.measureWidth,D=this.onTruncate,_=this.trimRight,m=[],T=d(r.text),g=T.split(`
`).map(function(K){return K.split(" ")}),w=!0,y=this.ellipsisWidth(this.elements.ellipsis),b=1;b<=c;b++){var j=g[0];if(j.length===0){m.push(),g.shift(),b--;continue}var P=j.join(" ");if(h(P)<=l&&g.length===1){w=!1,m.push(P);break}if(b===c){for(var L=j.join(" "),E=0,F=L.length-1;E<=F;){var O=Math.floor((E+F)/2),I=L.slice(0,O+1);h(I)+y<=l?E=O+1:F=O-1}var W=L.slice(0,E);if(u)for(W=_(W);!W.length&&m.length;){var B=m.pop();W=_(B)}P=p.createElement("span",null,W,a)}else{for(var v=0,S=j.length-1;v<=S;){var z=Math.floor((v+S)/2),q=j.slice(0,z+1).join(" ");h(q)<=l?v=z+1:S=z-1}if(v===0){b=c-1;continue}P=j.slice(0,v).join(" "),g[0].splice(0,v)}m.push(P)}return D(w),m}},{key:"renderLine",value:function(r,s,c){if(s===c.length-1)return p.createElement("span",{key:s},r);var a=p.createElement("br",{key:s+"br"});return r?[p.createElement("span",{key:s},r),a]:a}},{key:"render",value:function(){var r=this,s=this.elements.target,c=this.props,a=c.children,u=c.ellipsis,l=c.lines,d=te(c,["children","ellipsis","lines"]),h=this.state.targetWidth,D=this.getLines,_=this.renderLine,m=this.onTruncate,T=void 0,g=!!(s&&h);return typeof window<"u"&&g&&(l>0?T=D().map(_):(T=a,m(!1))),delete d.onTruncate,delete d.trimWhitespace,p.createElement("span",ee({},d,{ref:function(y){r.elements.target=y}}),p.createElement("span",null,T),p.createElement("span",{ref:function(y){r.elements.text=y}},a),p.createElement("span",{ref:function(y){r.elements.ellipsis=y},style:this.styles.ellipsis},u))}}]),t}(R.Component);M.propTypes={children:x.node,ellipsis:x.node,lines:x.oneOfType([x.oneOf([!1]),x.number]),trimWhitespace:x.bool,width:x.number,onTruncate:x.func};M.defaultProps={children:"",ellipsis:"â€¦",lines:1,trimWhitespace:!1,width:0};const H=R.createContext({});function we(){return R.useContext(H).setData}function U(e){var t;if(e){const i=((t=e==null?void 0:e.details)==null?void 0:t.toLowerCase())||"";if(i){if(i.includes("deposit"))return"Deposit";if(i.includes("exchange"))return"Exchange";if(i.includes("withdraw"))return"Withdraw";if(i.includes("transfer"))return"Transfer"}}return"Transaction"}const be=({children:e,...t})=>{const[i,r]=R.useState(),s=n.jsxs(o,{noPad:!0,xl:!0,medium:!0,children:[U(i==null?void 0:i.data)," details"]}),c=a=>{var u,l;if(a){const d=((l=(u=a==null?void 0:a.data)==null?void 0:u.details)==null?void 0:l.toLowerCase())||"";return d.includes("deposit")?pe(a):d.includes("exchange")?fe(a):d.includes("withdraw")?oe(a):d.includes("transfer")?de(a):le(a)}};return n.jsxs(H.Provider,{value:{...t,setData:(a=null)=>{if(a&&a.data){const u=a.data,l=u.currency_id;switch(u.currency=t.currencies.find(d=>{var h;return d.id==((h=a.data)==null?void 0:h.currency_id)}),U(a.data)){case"Deposit":u.deposit=t.deposits.find(d=>d.cryptomus_uuid===(u==null?void 0:u.ref));break;case"Exchange":u.exchanges=t.exchanges.find(d=>d.transaction_id===u.trnx&&(u.type==="+"&&d.to==l||u.type=="-"&&d.from==l));break;case"Withdraw":u.withdrawals=t.withdrawals.find(d=>d.ref==u.ref);case"Transfer":u.transfers=t.transfers.find(d=>d.transaction_ref==u.ref)}}r(a)}},children:[n.jsx(V,{className:"!bg-theme-bgColor",position:"right",header:s,visible:!!i,onHide:()=>r(null),children:c(i)}),e]})};function C(e,t){return n.jsx("div",{className:"mt-4 px-1",children:e.map(i=>{var s,c;const r=i.render?i.render((s=t.data)==null?void 0:s[i.key]):t.data[i.key]?n.jsx(o,{children:(c=t.data)==null?void 0:c[i.key]}):null;return r?n.jsxs("div",{className:"flex items-center py-1.5",children:[n.jsx(o,{md:!0,noPad:!0,light:!0,bright:!0,children:i.name}),n.jsx("div",{className:"flex justify-end grow",children:r})]},i.name):""})})}const se=[{name:"Status",key:"status",render(e){return n.jsx(N,{stats:e,value:e})}},{name:"Reject Reason",key:"withdrawals",render(e){if(console.log(e),e.status==2)return n.jsx(o,{noPad:!0,light:!0,children:e.reject_reason})}},{name:"Date",key:"updated_at",render(e){const t=k(e);return n.jsxs(o,{className:"flex items-center gap-2",children:[n.jsx("span",{children:t.localTime})," ",t.time]})}},{name:"Coin",key:"currency",render(e){return n.jsx(o,{noPad:!0,light:!0,children:e.code})}},{name:"Withdraw amount",key:"amount"},{name:"Network",key:"withdrawals",render(e){return n.jsx(o,{children:e==null?void 0:e.network})}},{name:"Fees",key:"charge",render(e){return e<=0?n.jsx(o,{noPad:!0,children:"No Fees"}):n.jsx(o,{noPad:!0,children:e})}},{name:"Ref",key:"ref",render(e){return n.jsx(f,{value:e})}},{name:"TxID",key:"trnx",render(e){return n.jsx(f,{value:e})}}],oe=e=>n.jsx(n.Fragment,{children:C(se,e)}),ce=[{key:"status",name:"Status",render(e){return n.jsx(N,{stats:e,value:e})}},{name:"Date",key:"updated_at",render(e){const t=k(e);return n.jsxs(o,{className:"flex items-center gap-2",children:[n.jsx("span",{children:t.localTime})," ",t.time]})}},{key:"amount",name:"Amount"},{key:"currency",name:"Coin",render(e){return n.jsx(o,{noPad:!0,children:e.code})}},{name:"Transaction Fees",key:"charge",render(e){return e<=0?n.jsx(o,{noPad:!0,children:"No Fees"}):n.jsx(o,{noPad:!0,children:e})}},{name:"Transaction ID",key:"trnx",render(e){return n.jsx(f,{value:e})}},{name:"Ref",key:"ref",render(e){return n.jsx(f,{value:e.transaction_id})}}],de=e=>C(ce,e),ue=[{key:"status",name:"Status",render(e){return n.jsx(N,{stats:e,value:e})}},{name:"Date",key:"updated_at",render(e){const t=k(e);return n.jsxs(o,{className:"flex items-center gap-2",children:[n.jsx("span",{children:t.localTime})," ",t.time]})}},{key:"amount",name:"Amount"},{key:"currency",name:"Coin",render(e){return n.jsx(o,{noPad:!0,children:e.code})}},{name:"Transaction Fees",key:"charge",render(e){return e<=0?n.jsx(o,{noPad:!0,children:"No Fees"}):n.jsx(o,{noPad:!0,children:e})}},{name:"Transaction ID",key:"trnx",render(e){return n.jsx(f,{value:e})}},{name:"Ref",key:"ref",render(e){return n.jsx(f,{value:e.transaction_id})}}],le=e=>C(ue,e),he=[{key:"status",name:"Status",render(e){return n.jsx(N,{stats:e,value:e})}},{key:"exchanges",name:"Exchange Type",render(e){return n.jsx(o,{noPad:!0,children:e.type})}},{name:"Date",key:"updated_at",render(e){const t=k(e);return n.jsxs(o,{className:"flex items-center gap-2",children:[n.jsx("span",{children:t.localTime})," ",t.time]})}},{key:"amount",name:"Exchange Amount"},{key:"currency",name:"Coin",render(e){return n.jsx(o,{noPad:!0,children:e.code})}},{name:"Trade Category",key:"type",render(e){return e==="+"?n.jsx(o,{noPad:!0,children:"Buy"}):n.jsx(o,{noPad:!0,children:"Sell"})}},{name:"Transaction Fees",key:"charge",render(e){return e<=0?n.jsx(o,{noPad:!0,children:"No Fees"}):n.jsx(o,{noPad:!0,children:e})}},{name:"Rate",key:"exchanges",render(e){return console.log(e),n.jsx(o,{children:n.jsx(A,{thousandSeparator:!0,displayType:"text",value:e==null?void 0:e.rate})})}},{name:"Limit Rate",key:"exchanges",render(e){return e.limit_rate?n.jsx("div",{children:n.jsx(o,{noPad:!0,children:n.jsx(A,{thousandSeparator:!0,displayType:"text",value:e.limit_rate})})}):n.jsx(o,{noPad:!0,children:"Unset"})}},{name:"Expiry Date",key:"exchanges",render(e){if(e.expire_in){const t=k(e.updated_at);return n.jsxs(o,{className:"flex gap-2",noPad:!0,children:[n.jsx("span",{children:t.date})," ",t.time]})}return n.jsx(o,{noPad:!0,children:"Unset"})}},{name:"Transaction Ref",key:"ref",render(e){return n.jsx(f,{value:e})}},{name:"Exchange Ref",key:"exchanges",render(e){return n.jsx(f,{value:e.transaction_id})}}],fe=e=>{var t,i;return n.jsxs(n.Fragment,{children:[C(he,e),J(((i=(t=e.data)==null?void 0:t.exchanges)==null?void 0:i.status)=="pending",n.jsx(n.Fragment,{children:n.jsx("div",{className:"flex mt-4",children:n.jsx(Q,{variant:"contained",className:"grow",centered:!0,bgColor:"warning",size:"normal",onClick:()=>{var r;$.post(route("user.crypto.cancel.swap",{id:(r=e.data)==null?void 0:r.exchanges.id}))},children:"Cancel"})})}))]})},me=[{name:"Status",key:"status",render(e){return n.jsx(N,{stats:e,value:e})}},{name:"Date",key:"updated_at",render(e){const t=k(e);return n.jsxs(o,{className:"flex items-center gap-2",children:[n.jsx("span",{children:t.localTime})," ",t.time]})}},{name:"Coin",key:"currency",render(e){return n.jsx(o,{noPad:!0,light:!0,children:e.code})}},{name:"Deposit amount",key:"amount"},{name:"Network",key:"deposit",render(e){return n.jsx(o,{children:e.network})}},{name:"Address",key:"deposit",render(e){return n.jsx(f,{value:e.wallet_address})}},{name:"Ref",key:"ref",render(e){return n.jsx(f,{value:e})}},{name:"TxID",key:"trnx",render(e){return n.jsx(f,{value:e})}}],pe=e=>C(me,e),f=({value:e,className:t=""})=>{const i=Z();return n.jsxs("div",{className:"flex gap-3 items-center",children:[n.jsx(o,{noPad:!0,className:t,children:n.jsx(M,{width:150,ellipsis:n.jsx("span",{children:"..."}),children:e})}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(o,{noPad:!0,brighter:!0,children:n.jsx(X,{})}),n.jsx(o,{noPad:!0,brighter:!0,onClick:()=>{window.navigator.clipboard.writeText(e).then(r=>i({closable:!0,severity:"success",summary:"Copied successfully"}))},children:n.jsx(Y,{})})]})]})},N=({value:e,stats:t,textProps:i={}})=>(t=t.toLowerCase(),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:G("border-4 rounded-full",{"border-success-400":t.includes("success"),"border-danger":t.includes("failed"),"border-warning":t.includes("pending")||t.includes("cancel")})}),n.jsx(o,{noPad:!0,sm:!0,medium:!0,...i,children:e})]}));export{f as C,N as S,be as T,we as u};
